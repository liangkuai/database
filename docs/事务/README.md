# 事务（Transaction）

在数据库系统中，一个事务是指：由一系列数据库操作组成的一个完整的逻辑过程。


## 事务特性（ACID）

- 原子性（Atomicity）
- 一致性（Consistency）
- 隔离性（Isolation）
- 持久性（Durability）

### 原子性
**事务的原子性是指事务必须是一个原子的操作序列单元。事务中包含的各项操作在一次执行过程中，要么全部执行，要么全部不执行。**

任何一项操作失败都将导致整个事务失败，同时其他已经被执行的操作都将被撤销并回滚。只有所有的操作全部成功，整个事务才算是成功完成。


### 一致性
**事务的一致性是指事务的执行不能破坏数据库数据的完整性和一致性，一个事务在执行前后，数据库都必须处于一致性状态**。换句话说，事务的执行结果必须是使数据库从一个一致性状态转变到另一个一致性状态。


### 隔离性
数据库允许多个并发事务同时对其数据进行读写和修改的能力。

**事务的隔离性是指在并发环境中，并发的事务是相互隔离的，事务之间互不干扰。防止多个事务并发执行时由于交叉执行而导致数据的不一致。**

> 在多个事务并发操作的过程中，如果没有进行事务隔离，或者控制不好隔离级别，就有可能产生
>
> - 脏读
> - 不可重复读
> - 幻读


### 持久性
**事务的持久性又称为永久性，是指一个事务一旦提交，对数据库中对应数据的状态变更就应该是永久性的**。即使发生系统崩溃或机器宕机等故障，只要数据库能够重新启动，那么一定能够将其恢复到事务成功结束时的状态。


### ACID 之间的关系
事务的 ACID 特性概念很简单，但不好理解，主要是因为这几个特性不是一种平级关系：

- 只有满足一致性，事务的结果才是正确的；

- 在没有并发的情况下，事务串行执行，隔离性一定能够满足。此时只要能满足原子性，就一定能满足一致性；

- 在并发的情况下，多个事务并行执行，事务不仅要满足原子性，还需要满足隔离性，才能满足一致性；

- 事务满足持久性是为了能应对数据库崩溃的情况。


### 参考
- [彻底理解数据库事务 - hollis](https://www.hollischuang.com/archives/898)